import{_ as c,r as i,o as p,c as l,b as n,a as e,d as s,e as o}from"./app.0ef7ca6e.js";const r={},u=n("p",null,[s("\u5E73\u53F0\u5C01\u88C5\u4E86 "),n("code",null,"axios"),s("\uFF0C\u652F\u6301\u6240\u6709\u8BF7\u6C42\u65B9\u5F0F\uFF0C\u5185\u7F6E "),n("code",null,"token"),s(" \u53CA\u8FC7\u671F\u81EA\u52A8\u5237\u65B0")],-1),d=n("h2",{id:"\u4EE3\u7801\u601D\u8DEF",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4EE3\u7801\u601D\u8DEF","aria-hidden":"true"},"#"),s(" \u4EE3\u7801\u601D\u8DEF")],-1),h={id:"_1-\u8BF7\u6C42\u52A0\u8F7D\u52A8\u753B\u9009\u7528-nprogress",tabindex:"-1"},k=n("a",{class:"header-anchor",href:"#_1-\u8BF7\u6C42\u52A0\u8F7D\u52A8\u753B\u9009\u7528-nprogress","aria-hidden":"true"},"#",-1),_=s(" 1. \u8BF7\u6C42\u52A0\u8F7D\u52A8\u753B\u9009\u7528 "),m={href:"https://www.npmjs.com/package/nprogress",target:"_blank",rel:"noopener noreferrer"},b=n("code",null,"nprogress",-1),v=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u8BF7\u6C42\u62E6\u622A\u5F00\u542F\u52A8\u753B</span>
NProgress.start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u54CD\u5E94\u62E6\u622A\u53CA\u8BF7\u6C42\u5931\u8D25\u5173\u95ED\u52A8\u753B</span>
NProgress.done<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-\u901A\u7528\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-\u901A\u7528\u914D\u7F6E" aria-hidden="true">#</a> 2. \u901A\u7528\u914D\u7F6E</h3>`,3),g={href:"http://www.axios-js.com/zh-cn/docs/#axios-request-config-1",target:"_blank",rel:"noopener noreferrer"},x=s("axios \u4E2D\u6587\u6587\u6863"),f=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>const defaultConfig: AxiosRequestConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment"># \u76F8\u5BF9 URL\uFF08\u5E73\u53F0\u6839\u636E\u5F53\u524D\u73AF\u5883\u5224\u65ADbaseURL\u7684\u503C\uFF0CVITE_PROXY_DOMAIN_REAL\u4E3A\u7EBF\u4E0A\u73AF\u5883\u63A5\u53E3\u5730\u5740\uFF0CVITE_PROXY_DOMAIN\u4E3A\u672C\u5730\u5F00\u53D1\u73AF\u5883\u63A5\u53E3\u4EE3\u7406\u5730\u5740\uFF09</span>
  baseURL: process .env.NODE_ENV <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">&quot;production&quot;</span> ? VITE_PROXY_DOMAIN_REAL <span class="token builtin class-name">:</span> VITE_PROXY_DOMAIN,
  <span class="token comment"># \u8BF7\u6C42\u8D85\u65F6\u65F6\u95F4</span>
  timeout: <span class="token number">10000</span>,
  <span class="token comment"># \u8BF7\u6C42\u5934</span>
  headers: <span class="token punctuation">{</span>
    Accept: <span class="token string">&quot;application/json, text/plain, */*&quot;</span>,
    <span class="token string">&quot;Content-Type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;application/json&quot;</span>,
    <span class="token string">&quot;X-Requested-With&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;XMLHttpRequest&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token comment"># \u91C7\u7528qs\u5C06\u6570\u7EC4\u683C\u5F0F\u53C2\u6570\u5E8F\u5217\u5316\uFF08\u652F\u6301\u6570\u7EC4\u683C\u5F0F\u7684\u53C2\u6570\uFF09</span>
  paramsSerializer: params <span class="token operator">=</span><span class="token operator">&gt;</span> qs.stringify<span class="token punctuation">(</span>params, <span class="token punctuation">{</span> indices: <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-\u5C06\u6240\u6709\u8BF7\u6C42\u5DE5\u5177\u548C\u65B9\u6CD5\u90FD\u5C01\u88C5\u5728\u4E86\u4E00\u4E2A\u53EBpurehttp\u7684\u7C7B" tabindex="-1"><a class="header-anchor" href="#_3-\u5C06\u6240\u6709\u8BF7\u6C42\u5DE5\u5177\u548C\u65B9\u6CD5\u90FD\u5C01\u88C5\u5728\u4E86\u4E00\u4E2A\u53EBpurehttp\u7684\u7C7B" aria-hidden="true">#</a> 3. \u5C06\u6240\u6709\u8BF7\u6C42\u5DE5\u5177\u548C\u65B9\u6CD5\u90FD\u5C01\u88C5\u5728\u4E86\u4E00\u4E2A\u53EB<code>PureHttp</code>\u7684\u7C7B</h3>`,2),q=s("\u4E24\u4E2A\u6784\u9020\u51FD\u6570\uFF0C\u5728"),y=n("code",null,"PureHttp",-1),T=s("\u521B\u5EFA\u6216\u8005\u5B9E\u4F8B\u5316\u65F6\u5019\u88AB\u8C03\u7528\uFF1A"),L=n("br",null,null,-1),R=s(" \u2460 \u8BF7\u6C42\u62E6\u622A "),w={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/http/index.ts#L48",target:"_blank",rel:"noopener noreferrer"},I=n("code",null,"httpInterceptorsRequest",-1),N=s(),E=n("br",null,null,-1),O=s(" \u2461 \u54CD\u5E94\u62E6\u622A "),A={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/http/index.ts#L91",target:"_blank",rel:"noopener noreferrer"},P=n("code",null,"httpInterceptorsResponse",-1),V=s(),B=s("\u5DE5\u5177\u51FD\u6570"),C=n("br",null,null,-1),D=s(" \u2460 \u901A\u7528\u8BF7\u6C42\u5DE5\u5177\u51FD\u6570 "),X={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/http/index.ts#L121",target:"_blank",rel:"noopener noreferrer"},M=n("code",null,"request",-1),S=s(),U=n("br",null,null,-1),j=s(" \u2461 \u5355\u72EC\u62BD\u79BB\u7684 post \u5DE5\u5177\u51FD\u6570 "),z={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/http/index.ts#L148",target:"_blank",rel:"noopener noreferrer"},H=n("code",null,"post",-1),Y=s(),$=n("br",null,null,-1),G=s(" \u2462 \u5355\u72EC\u62BD\u79BB\u7684 get \u5DE5\u5177\u51FD\u6570 "),J={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/http/index.ts#L157",target:"_blank",rel:"noopener noreferrer"},K=n("code",null,"get",-1),W=s(),F=n("h3",{id:"_4-token-\u53CA\u8FC7\u671F\u81EA\u52A8\u5237\u65B0",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_4-token-\u53CA\u8FC7\u671F\u81EA\u52A8\u5237\u65B0","aria-hidden":"true"},"#"),s(" 4. Token \u53CA\u8FC7\u671F\u81EA\u52A8\u5237\u65B0")],-1),Q=s("\u8FD9\u91CC\u6D89\u53CA\u4E09\u4E2A\u6587\u4EF6"),Z=n("br",null,null,-1),nn=s(" \u2460 "),sn={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/auth.ts",target:"_blank",rel:"noopener noreferrer"},en=s("auth.ts"),an=s(),tn=n("br",null,null,-1),on=s(" \u2461 "),cn={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/store/modules/user.ts",target:"_blank",rel:"noopener noreferrer"},pn=s("user.ts"),ln=s(),rn=n("br",null,null,-1),un=s(" \u2462 "),dn={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/http/index.ts#L63",target:"_blank",rel:"noopener noreferrer"},hn=s("http/index.ts"),kn=s(),_n=o('<h4 id="auth-ts\u4EE3\u7801\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#auth-ts\u4EE3\u7801\u89E3\u6790" aria-hidden="true">#</a> <code>auth.ts</code>\u4EE3\u7801\u89E3\u6790\uFF1A</h4><ul><li>\u5B58\u50A8<code>token</code>\u653E\u5165<code>Cookies</code>\u548C<code>sessionStorage</code>\uFF0C\u952E\u540D\uFF1A<code>TokenKey</code></li><li>\u66B4\u9732\u65B9\u6CD5\uFF1A<br> \u2460 <code>getToken</code>\uFF1A\u83B7\u53D6 token<br> \u2461 <code>setToken</code>\uFF1A\u8BBE\u7F6E token \u4EE5\u53CA\u8FC7\u671F\u65F6\u95F4\uFF08\u540E\u7AEF\u9700\u8981\u5C06\u7528\u6237\u4FE1\u606F\u548C token \u4EE5\u53CA\u8FC7\u671F\u65F6\u95F4\u90FD\u8FD4\u56DE\u7ED9\u524D\u7AEF\uFF0C\u8FC7\u671F\u65F6\u95F4\u4E3B\u8981\u7528\u4E8E\u5237\u65B0 token\uFF0C\u5F53\u7136\u60A8\u4E5F\u53EF\u4EE5\u4E0D\u91C7\u7528\u6B64\u79CD\u65B9\u6CD5\u5237\u65B0 token\uFF0C\u60A8\u53EF\u4EE5\u81EA\u884C\u7F16\u5199\u6839\u636E\u72B6\u6001\u7801\u5224\u65AD\u662F\u5426 token \u8FC7\u671F\uFF09<br> \u2462 <code>removeToken</code>\uFF1A\u5220\u9664 token</li></ul><h4 id="user-ts\u4EE3\u7801\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#user-ts\u4EE3\u7801\u89E3\u6790" aria-hidden="true">#</a> <code>user.ts</code>\u4EE3\u7801\u89E3\u6790\uFF1A</h4><ul><li>\u4E24\u4E2A\u53D8\u91CF<br><code>token</code>\u3001<code>name</code></li><li>\u4E09\u4E2A\u65B9\u6CD5<br> \u2460 \u901A\u8FC7<code>loginByUsername</code>\u8C03\u7528\u767B\u5F55\u63A5\u53E3\u8FDB\u884C\u767B\u5F55<br> \u2461 \u901A\u8FC7<code>logOut</code>\u8C03\u7528\u767B\u51FA\u51FD\u6570\u8FDB\u884C\u6E05\u7A7A\u7F13\u5B58\u4FE1\u606F\u5E76\u767B\u51FA<br> \u2462 \u901A\u8FC7<code>refreshToken</code>\u8C03\u7528\u5237\u65B0 token \u63A5\u53E3\u8FDB\u884C token \u5237\u65B0</li></ul><h4 id="http-index-ts\u4EE3\u7801\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#http-index-ts\u4EE3\u7801\u89E3\u6790" aria-hidden="true">#</a> <code>http/index.ts</code>\u4EE3\u7801\u89E3\u6790\uFF1A</h4><p><code>request</code> \u516C\u5171\u901A\u7528\u65B9\u6CD5\u53C2\u6570\uFF1A<code>method</code>\u8BF7\u6C42\u65B9\u6CD5\u3001<code>url</code>\u8BF7\u6C42\u5730\u5740\u3001<code>param</code>\u8BF7\u6C42\u53C2\u6570\u3001<code>axiosConfig</code>\u989D\u5916\u914D\u7F6E<br><code>post</code> \u516C\u5171 post \u8BF7\u6C42\u53C2\u6570\uFF1A<code>url</code>\u8BF7\u6C42\u5730\u5740\u3001<code>params</code>\u8BF7\u6C42\u53C2\u6570\u3001<code>config</code>\u989D\u5916\u914D\u7F6E<br><code>get</code> \u516C\u5171 get \u8BF7\u6C42\u53C2\u6570\uFF1A<code>url</code>\u8BF7\u6C42\u5730\u5740\u3001<code>params</code>\u8BF7\u6C42\u53C2\u6570\u3001<code>config</code>\u989D\u5916\u914D\u7F6E</p>',6),mn={href:"https://gitee.com/yiming_chang/vue-pure-admin/blob/main/src/utils/http/index.ts#L63",target:"_blank",rel:"noopener noreferrer"},bn=s("token \u8FC7\u671F\u5224\u65AD"),vn=s(),gn=s(" \u4E3B\u8981\u89C2\u5BDF expired\uFF0C\u901A\u8FC7\u8FC7\u671F\u65F6\u95F4\u6233\u51CF\u53BB\u5F53\u524D\u65F6\u95F4\u6233\uFF0C\u5982\u679C\u5927\u4E8E 0\uFF0C\u5219\u8BF4\u660E token \u6CA1\u6709\u8FC7\u671F\uFF0C\u5982\u679C\u5C0F\u4E8E\u7B49\u4E8E 0 \u5219 token \u8FC7\u671F"),xn=o(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>const token <span class="token operator">=</span> getToken<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  const data <span class="token operator">=</span> JSON.parse<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  const now <span class="token operator">=</span> new Date<span class="token punctuation">(</span><span class="token punctuation">)</span>.getTime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  const expired <span class="token operator">=</span> parseInt<span class="token punctuation">(</span>data.expires<span class="token punctuation">)</span> - now <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>expired<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment"># token\u8FC7\u671F\u5237\u65B0</span>
    useUserStoreHook<span class="token punctuation">(</span><span class="token punctuation">)</span>
      .refreshToken<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      .then<span class="token punctuation">((</span>res: resultType<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        config.headers<span class="token punctuation">[</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Bearer &quot;</span> + res.accessToken<span class="token punctuation">;</span>
        <span class="token builtin class-name">return</span> <span class="token variable">$config</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    config.headers<span class="token punctuation">[</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Bearer &quot;</span> + data.accessToken<span class="token punctuation">;</span>
    <span class="token builtin class-name">return</span> <span class="token variable">$config</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token builtin class-name">return</span> <span class="token variable">$config</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u4F7F\u7528\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528\u65B9\u6CD5" aria-hidden="true">#</a> \u4F7F\u7528\u65B9\u6CD5</h2><h3 id="get-\u8BF7\u6C42" tabindex="-1"><a class="header-anchor" href="#get-\u8BF7\u6C42" aria-hidden="true">#</a> Get \u8BF7\u6C42</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">import</span> <span class="token punctuation">{</span> http <span class="token punctuation">}</span> from <span class="token string">&quot;/@/utils/http&quot;</span><span class="token punctuation">;</span>

// params\u4F20\u53C2
http.request<span class="token punctuation">(</span><span class="token string">&#39;get&#39;</span>, <span class="token string">&#39;/xxx&#39;</span>, <span class="token punctuation">{</span> params: param <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

// url\u62FC\u63A5\u4F20\u53C2
http.request<span class="token punctuation">(</span><span class="token string">&#39;get&#39;</span>, <span class="token string">&#39;/xxx?message=&#39;</span> + msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="post-\u8BF7\u6C42" tabindex="-1"><a class="header-anchor" href="#post-\u8BF7\u6C42" aria-hidden="true">#</a> Post \u8BF7\u6C42</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">import</span> <span class="token punctuation">{</span> http <span class="token punctuation">}</span> from <span class="token string">&quot;/@/utils/http&quot;</span><span class="token punctuation">;</span>

// params\u4F20\u53C2
http.request<span class="token punctuation">(</span><span class="token string">&#39;post&#39;</span>, <span class="token string">&#39;/xxx&#39;</span>, <span class="token punctuation">{</span> params: param <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

// data\u4F20\u53C2
http.request<span class="token punctuation">(</span><span class="token string">&#39;post&#39;</span>, <span class="token string">&#39;/xxx&#39;</span>, <span class="token punctuation">{</span> data: param <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6);function fn(qn,yn){const a=i("ExternalLinkIcon"),t=i("Badge");return p(),l("div",null,[u,d,n("h3",h,[k,_,n("a",m,[b,e(a)])]),v,n("ul",null,[n("li",null,[n("a",g,[x,e(a)])])]),f,n("ul",null,[n("li",null,[q,y,T,L,R,n("a",w,[I,e(a)]),N,e(t,{text:"\u4EE3\u7801"}),E,O,n("a",A,[P,e(a)]),V,e(t,{text:"\u4EE3\u7801"})]),n("li",null,[B,C,D,n("a",X,[M,e(a)]),S,e(t,{text:"\u4EE3\u7801"}),U,j,n("a",z,[H,e(a)]),Y,e(t,{text:"\u4EE3\u7801"}),$,G,n("a",J,[K,e(a)]),W,e(t,{text:"\u4EE3\u7801"})])]),F,n("ul",null,[n("li",null,[Q,Z,nn,n("a",sn,[en,e(a)]),an,e(t,{text:"\u4EE3\u7801"}),tn,on,n("a",cn,[pn,e(a)]),ln,e(t,{text:"\u4EE3\u7801"}),rn,un,n("a",dn,[hn,e(a)]),kn,e(t,{text:"\u4EE3\u7801"})])]),_n,n("ul",null,[n("li",null,[n("a",mn,[bn,e(a)]),vn,e(t,{text:"\u4EE3\u7801"}),gn])]),xn])}var Ln=c(r,[["render",fn],["__file","index.html.vue"]]);export{Ln as default};
